# ğŸ—ï¸ Online Shopping Platform - Architecture Diagram

## ğŸ“Š System Overview

```

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Account  â”‚ â”‚  Item    â”‚ â”‚  Order   â”‚ â”‚ Payment  â”‚
â”‚ Service  â”‚ â”‚ Service  â”‚ â”‚ Service  â”‚ â”‚ Service  â”‚
â”‚ :8081    â”‚ â”‚ :8082    â”‚ â”‚ :8083    â”‚ â”‚ :8084    â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
     â”‚            â”‚            â”‚  â”‚          â”‚  â”‚
     â”‚            â”‚            â”‚  â”‚          â”‚  â”‚
     â–¼            â–¼            â–¼  â”‚          â–¼  â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”
â”‚  MySQL  â”‚  â”‚  MySQL  â”‚  â”‚Cassandraâ”‚  â”‚Cassandraâ”‚
â”‚ (Acc DB)â”‚  â”‚(Item DB)â”‚  â”‚(Ord DB) â”‚  â”‚(Pay DB) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
                                â”‚            â”‚
                                â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
                                     â–¼
                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                            â”‚  Kafka Cluster  â”‚
                            â”‚    :9092        â”‚
                            â”‚                 â”‚
                            â”‚ Topics:         â”‚
                            â”‚ â€¢ payment.eventsâ”‚
                            â”‚ â€¢ order.events  â”‚
                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```







## ğŸ”„ Detailed Component Interaction Flow

### 1ï¸âƒ£ Authentication Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚Frontendâ”‚                  â”‚ Account Service â”‚                 â”‚  MySQL  â”‚
â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
    â”‚                                â”‚                                â”‚
    â”‚ POST /api/v1/accounts/register â”‚                                â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                                â”‚
    â”‚                                â”‚ INSERT user                    â”‚
    â”‚                                â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
    â”‚                                â”‚ <â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚ 201 Created                    â”‚                                â”‚
    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                                â”‚
    â”‚                                â”‚                                â”‚
    â”‚ POST /api/v1/auth/login        â”‚                                â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                                â”‚
    â”‚                                â”‚ SELECT user, verify password   â”‚
    â”‚                                â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
    â”‚                                â”‚ <â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚ 200 OK                         â”‚                                â”‚
    â”‚ { token: "JWT..." }            â”‚                                â”‚
    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                                â”‚
    â”‚                                â”‚                                â”‚
    â”‚ Store token in localStorage    â”‚                                â”‚
    â”‚                                â”‚                                â”‚
```

### 2ï¸âƒ£ Browse Items Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚Frontendâ”‚                  â”‚ Item Service â”‚                 â”‚  MySQL  â”‚
â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                 â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
    â”‚                              â”‚                              â”‚
    â”‚ GET /api/v1/items            â”‚                              â”‚
    â”‚ Authorization: Bearer JWT    â”‚                              â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                              â”‚
    â”‚                              â”‚ Verify JWT                   â”‚
    â”‚                              â”‚                              â”‚
    â”‚                              â”‚ SELECT * FROM items          â”‚
    â”‚                              â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
    â”‚                              â”‚ <â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚ 200 OK                       â”‚                              â”‚
    â”‚ [{ id, upc, name, price,     â”‚                              â”‚
    â”‚    availableUnits }]         â”‚                              â”‚
    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                              â”‚
    â”‚                              â”‚                              â”‚
```

### 3ï¸âƒ£ Create Order Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚Frontendâ”‚                  â”‚Order Service â”‚                 â”‚Cassandra â”‚
â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                 â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
    â”‚                              â”‚                              â”‚
    â”‚ POST /api/v1/orders          â”‚                              â”‚
    â”‚ Authorization: Bearer JWT    â”‚                              â”‚
    â”‚ { items: [                   â”‚                              â”‚
    â”‚   {upc: "UPC001", qty: 2}    â”‚                              â”‚
    â”‚ ]}                           â”‚                              â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                              â”‚
    â”‚                              â”‚ 1. Verify JWT                â”‚
    â”‚                              â”‚ 2. Extract user email        â”‚
    â”‚                              â”‚ 3. Call Item Service         â”‚
    â”‚                              â”‚    to get prices             â”‚
    â”‚                              â”‚ 4. Calculate total           â”‚
    â”‚                              â”‚                              â”‚
    â”‚                              â”‚ INSERT order                 â”‚
    â”‚                              â”‚ status = CREATED             â”‚
    â”‚                              â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
    â”‚                              â”‚ <â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚ 201 Created                  â”‚                              â”‚
    â”‚ { id, status: "CREATED",     â”‚                              â”‚
    â”‚   totalAmount, items }       â”‚                              â”‚
    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                              â”‚
    â”‚                              â”‚                              â”‚
```

### 4ï¸âƒ£ Payment & Order Completion Flow (Event-Driven)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚Frontendâ”‚   â”‚Payment Serviceâ”‚   â”‚Cassandra â”‚   â”‚ Kafka â”‚   â”‚Order Service â”‚
â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”¬â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚               â”‚                 â”‚             â”‚              â”‚
    â”‚ POST /api/v1/payments           â”‚             â”‚              â”‚
    â”‚ { orderId, amount }             â”‚             â”‚              â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                 â”‚             â”‚              â”‚
    â”‚               â”‚ 1. Verify JWT   â”‚             â”‚              â”‚
    â”‚               â”‚ 2. Call Order   â”‚             â”‚              â”‚
    â”‚               â”‚    Service to   â”‚             â”‚              â”‚
    â”‚               â”‚    verify order â”‚             â”‚              â”‚
    â”‚               â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
    â”‚               â”‚ <â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚               â”‚                 â”‚             â”‚              â”‚
    â”‚               â”‚ 3. Validate     â”‚             â”‚              â”‚
    â”‚               â”‚    amount       â”‚             â”‚              â”‚
    â”‚               â”‚                 â”‚             â”‚              â”‚
    â”‚               â”‚ INSERT payment  â”‚             â”‚              â”‚
    â”‚               â”‚ status=SUCCESS  â”‚             â”‚              â”‚
    â”‚               â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚             â”‚              â”‚
    â”‚               â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤             â”‚              â”‚
    â”‚               â”‚                 â”‚             â”‚              â”‚
    â”‚               â”‚ 4. Publish Eventâ”‚             â”‚              â”‚
    â”‚               â”‚ PaymentSucceededâ”‚             â”‚              â”‚
    â”‚               â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚              â”‚
    â”‚               â”‚                 â”‚             â”‚              â”‚
    â”‚ 201 Created   â”‚                 â”‚             â”‚ 5. Consume   â”‚
    â”‚ { paymentId,  â”‚                 â”‚             â”‚    Event     â”‚
    â”‚   status }    â”‚                 â”‚             â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                 â”‚             â”‚              â”‚
    â”‚               â”‚                 â”‚             â”‚ 6. Mark orderâ”‚
    â”‚               â”‚                 â”‚             â”‚    COMPLETED â”‚
    â”‚               â”‚                 â”‚             â”‚              â”‚
    â”‚               â”‚                 â”‚             â”‚ 7. Deduct    â”‚
    â”‚               â”‚                 â”‚             â”‚    inventory â”‚
    â”‚               â”‚                 â”‚             â”‚    (call Itemâ”‚
    â”‚               â”‚                 â”‚             â”‚    Service)  â”‚
    â”‚               â”‚                 â”‚             â”‚              â”‚
```

### 5ï¸âƒ£ Order Cancellation & Refund Flow (Event-Driven)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚Frontendâ”‚   â”‚Order Service â”‚   â”‚ Kafka â”‚   â”‚Payment Serviceâ”‚   â”‚Cassandra â”‚
â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”¬â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
    â”‚               â”‚               â”‚               â”‚                 â”‚
    â”‚ POST /api/v1/orders/{id}/cancel                                 â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚               â”‚               â”‚                 â”‚
    â”‚               â”‚ 1. Verify JWT â”‚               â”‚                 â”‚
    â”‚               â”‚                â”‚               â”‚                 â”‚
    â”‚               â”‚ UPDATE order   â”‚               â”‚                 â”‚
    â”‚               â”‚ status=CANCELEDâ”‚               â”‚                 â”‚
    â”‚               â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
    â”‚               â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚               â”‚                â”‚               â”‚                 â”‚
    â”‚               â”‚ 2. Restore     â”‚               â”‚                 â”‚
    â”‚               â”‚    inventory   â”‚               â”‚                 â”‚
    â”‚               â”‚    (call Item  â”‚               â”‚                 â”‚
    â”‚               â”‚    Service)    â”‚               â”‚                 â”‚
    â”‚               â”‚                â”‚               â”‚                 â”‚
    â”‚               â”‚ 3. Publish     â”‚               â”‚                 â”‚
    â”‚               â”‚    Event       â”‚               â”‚                 â”‚
    â”‚               â”‚ OrderCancelled â”‚               â”‚                 â”‚
    â”‚               â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚               â”‚                 â”‚
    â”‚               â”‚                â”‚               â”‚                 â”‚
    â”‚ 200 OK        â”‚                â”‚ 4. Consume    â”‚                 â”‚
    â”‚ { status:     â”‚                â”‚    Event      â”‚                 â”‚
    â”‚   CANCELED }  â”‚                â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                 â”‚
    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                â”‚               â”‚                 â”‚
    â”‚               â”‚                â”‚               â”‚ 5. UPDATE       â”‚
    â”‚               â”‚                â”‚               â”‚    payment      â”‚
    â”‚               â”‚                â”‚               â”‚    status=      â”‚
    â”‚               â”‚                â”‚               â”‚    REFUNDED     â”‚
    â”‚               â”‚                â”‚               â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
    â”‚               â”‚                â”‚               â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚               â”‚                â”‚               â”‚                 â”‚
```

## ğŸ—‚ï¸ Data Models

### Account Service (MySQL)

```sql
accounts
â”œâ”€â”€ email (PK)
â”œâ”€â”€ password_hash
â”œâ”€â”€ first_name
â”œâ”€â”€ last_name
â”œâ”€â”€ role
â”œâ”€â”€ created_at
â””â”€â”€ updated_at
```

### Item Service (MySQL)

```sql
items
â”œâ”€â”€ id (PK, UUID)
â”œâ”€â”€ upc (Unique)
â”œâ”€â”€ name
â”œâ”€â”€ unit_price
â”œâ”€â”€ available_units
â”œâ”€â”€ created_at
â””â”€â”€ updated_at
```

### Order Service (Cassandra)

```
orders
â”œâ”€â”€ id (PK, UUID)
â”œâ”€â”€ account_email
â”œâ”€â”€ status (CREATED, COMPLETED, CANCELED)
â”œâ”€â”€ total_amount
â”œâ”€â”€ items (List<OrderItem>)
â”‚   â”œâ”€â”€ item_id
â”‚   â”œâ”€â”€ upc
â”‚   â”œâ”€â”€ name
â”‚   â”œâ”€â”€ unit_price
â”‚   â””â”€â”€ quantity
â”œâ”€â”€ created_at
â””â”€â”€ updated_at
```

### Payment Service (Cassandra)

```
payments
â”œâ”€â”€ id (PK, UUID)
â”œâ”€â”€ order_id
â”œâ”€â”€ account_email
â”œâ”€â”€ status (SUCCESS, FAILED, REFUNDED)
â”œâ”€â”€ amount
â”œâ”€â”€ idempotency_key
â”œâ”€â”€ created_at
â””â”€â”€ updated_at
```

## ğŸ” Security Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    JWT Token Authentication                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

1. User logs in â†’ Account Service generates JWT
2. JWT contains:
   - Subject (email)
   - Issued At
   - Expiration
   - Signed with SECRET_KEY

3. Every request includes:
   Authorization: Bearer <JWT>

4. Each service validates JWT:
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ JwtAuthFilterâ”‚
   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â”œâ”€> Parse JWT
          â”œâ”€> Verify signature
          â”œâ”€> Check expiration
          â””â”€> Set SecurityContext

5. Spring Security:
   - @EnableMethodSecurity
   - SecurityFilterChain
   - @PreAuthorize annotations
```

## ğŸ“¨ Kafka Event Flow

### Topics

```
payment.events
â””â”€â”€ Events published by Payment Service
    â””â”€â”€ PaymentSucceeded
        â”œâ”€â”€ orderId
        â”œâ”€â”€ paymentId
        â”œâ”€â”€ amount
        â””â”€â”€ occurredAt

order.events
â””â”€â”€ Events published by Order Service
    â””â”€â”€ OrderCancelled
        â”œâ”€â”€ orderId
        â””â”€â”€ occurredAt
```

### Consumer Groups

```
order-service (Consumer Group)
â””â”€â”€ Listens to: payment.events
    â””â”€â”€ On PaymentSucceeded:
        â”œâ”€â”€ Update order status â†’ COMPLETED
        â””â”€â”€ Deduct inventory

payment-service (Consumer Group)
â””â”€â”€ Listens to: order.events
    â””â”€â”€ On OrderCancelled:
        â””â”€â”€ Update payment status â†’ REFUNDED
```

### Event Configuration

```
Order Service (application.properties):
â”œâ”€â”€ Consumer: payment.events
â”‚   â”œâ”€â”€ JsonDeserializer
â”‚   â”œâ”€â”€ Trusted packages: *
â”‚   â””â”€â”€ Default type: PaymentEventsListener$PaymentEvent
â””â”€â”€ Producer: order.events
    â””â”€â”€ JsonSerializer

Payment Service (application.properties):
â”œâ”€â”€ Consumer: order.events
â”‚   â”œâ”€â”€ JsonDeserializer
â”‚   â”œâ”€â”€ Trusted packages: *
â”‚   â””â”€â”€ Default type: OrderEventsListener$OrderEvent
â””â”€â”€ Producer: payment.events
    â””â”€â”€ JsonSerializer
```

## ğŸŒ Full Request Flow Example

### Complete Purchase Journey

```
1. USER ACTION: Browse Items
   Frontend â†’ Item Service â†’ MySQL
   Response: List of items with prices and availability

2. USER ACTION: Create Order
   Frontend â†’ Order Service â†’ Cassandra
   Order Service â†’ Item Service (verify items, get prices)
   Response: Order created (status: CREATED)

3. USER ACTION: Pay Now
   Frontend â†’ Payment Service
   Payment Service â†’ Order Service (verify order)
   Payment Service â†’ Cassandra (save payment)
   Payment Service â†’ Kafka (publish PaymentSucceeded)
   Response: Payment created (status: SUCCESS)

4. ASYNC: Order Completion
   Kafka â†’ Order Service (consume PaymentSucceeded)
   Order Service â†’ Cassandra (update order status â†’ COMPLETED)
   Order Service â†’ Item Service (deduct inventory)

5. USER ACTION: Cancel Order
   Frontend â†’ Order Service
   Order Service â†’ Cassandra (update status â†’ CANCELED)
   Order Service â†’ Item Service (restore inventory)
   Order Service â†’ Kafka (publish OrderCancelled)
   Response: Order canceled

6. ASYNC: Payment Refund
   Kafka â†’ Payment Service (consume OrderCancelled)
   Payment Service â†’ Cassandra (update payment status â†’ REFUNDED)
```

## ğŸ› ï¸ Technology Stack

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Frontend                                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ React 18                                                   â”‚
â”‚ â€¢ TypeScript                                                 â”‚
â”‚ â€¢ React Router                                               â”‚
â”‚ â€¢ Vite                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Backend Services (Java 21 + Spring Boot 3.x)                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ Spring Web                                                 â”‚
â”‚ â€¢ Spring Security                                            â”‚
â”‚ â€¢ Spring Data JPA (MySQL services)                          â”‚
â”‚ â€¢ Spring Data Cassandra (Order & Payment services)          â”‚
â”‚ â€¢ Spring Kafka                                               â”‚
â”‚ â€¢ JWT (io.jsonwebtoken)                                      â”‚
â”‚ â€¢ Validation                                                 â”‚
â”‚ â€¢ Lombok                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Databases                                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ MySQL 8.0 (Account, Item services)                        â”‚
â”‚ â€¢ Cassandra 4.1 (Order, Payment services)                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Message Broker                                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ Apache Kafka 3.9                                           â”‚
â”‚ â€¢ Zookeeper                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ DevOps                                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ Docker & Docker Compose                                    â”‚
â”‚ â€¢ Maven                                                      â”‚
â”‚ â€¢ npm                                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ¯ Key Design Patterns

### 1. **Microservices Architecture**
- Independent services
- Single Responsibility
- Decentralized data management

### 2. **Event-Driven Architecture**
- Asynchronous communication via Kafka
- Event sourcing for critical flows
- Eventual consistency

### 3. **API Gateway Pattern** (Implicit)
- Centralized entry point
- Authentication/Authorization
- Load balancing

### 4. **Database per Service**
- Service autonomy
- Technology diversity (MySQL + Cassandra)
- Data isolation

### 5. **CQRS** (Light implementation)
- Command: Order/Payment creation
- Query: Read operations
- Separate read/write concerns

### 6. **Saga Pattern** (Choreography)
- Distributed transactions
- PaymentSucceeded â†’ Complete Order
- OrderCancelled â†’ Refund Payment

### 7. **Circuit Breaker** (via RestTemplate)
- Fault tolerance
- Service-to-service calls
- Graceful degradation

## ğŸ“Š Service Communication Matrix

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Service   â”‚Accountâ”‚ Item â”‚ Order â”‚ Payment â”‚ Kafka â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Account     â”‚  -   â”‚  No  â”‚  No   â”‚   No    â”‚  No   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Item        â”‚  No  â”‚  -   â”‚  No   â”‚   No    â”‚  No   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Order       â”‚  No  â”‚ REST â”‚  -    â”‚   No    â”‚ Pub   â”‚
â”‚             â”‚      â”‚(get) â”‚       â”‚         â”‚(order)â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Payment     â”‚  No  â”‚  No  â”‚ REST  â”‚   -     â”‚ Pub   â”‚
â”‚             â”‚      â”‚      â”‚(get)  â”‚         â”‚(pay)  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Frontend    â”‚ REST â”‚ REST â”‚ REST  â”‚  REST   â”‚  No   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”˜

Kafka Consumers:
â€¢ Order Service â†’ payment.events
â€¢ Payment Service â†’ order.events
```

## ğŸ”„ State Transitions

### Order States

```
     CREATED
        â”‚
        â”‚ PaymentSucceeded
        â–¼
    COMPLETED â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚              â”‚
        â”‚ Cancel       â”‚ Cancel
        â–¼              â”‚
    CANCELED â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Payment States

```
     SUCCESS
        â”‚
        â”‚ OrderCancelled
        â–¼
    REFUNDED

    FAILED
    (terminal)
```

---

**Architecture Version**: 1.0  
**Last Updated**: November 15, 2025  
**Prepared For**: Demo & Documentation

